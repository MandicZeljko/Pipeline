pipeline {
    agent any
    options{
        ansiColor('xterm')
        
    }
    stages {
        stage('google') {
            parallel {
                
                stage('Firefox') {
                    steps{
                         bat 'npx cypress run --browser firefox -- --config videoRecording=false --spec cypress/e2e/google.cy.js'
                    }
                     
                }
                stage('chrome') {
                    steps{
                        bat 'npx cypress run --browser chrome  --config videoRecording=false -- spec cypress/e2e/google.cy.js'
                    }
                      
                }
            }

        }
        stage('yahoo'){
            parallel {
                
                stage('Firefox') {
                    steps{
                         bat 'npx cypress run --browser firefox  --config videoRecording=false --spec cypress/e2e/yahoo.cy.js'
                    }
                     
                }
                stage('chrome') {
                    steps{
                        bat 'npx cypress run --browser chrome --config videoRecording=false -- spec cypress/e2e/yahoo.cy.js'
                    }
                      
                }
            }
        }
    }

    post {
        always{
         mocha({
            "reporter": "mocha-jenkins-reporter",
            "reporterOptions": {
                "junit_report_name": "Tests",
                "junit_report_path": "report.xml",
                "junit_report_stack": 1
            }
        })
        }
    }
    
}
